$listenerScript = {
    $listener = New-Object System.Net.Sockets.TcpListener '0.0.0.0', 9999
    $listener.Start()
    Write-Host "Listening on port 9999"
    $client = $listener.AcceptTcpClient()
    Write-Host "Accepted client"
    $client.Close()
    Write-Host "Closed client"
    $listener.Stop()
    Write-Host "Stopped listening"
}

& $listenerScript
