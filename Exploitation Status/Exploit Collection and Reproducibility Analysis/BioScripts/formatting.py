import csv

csv.field_size_limit(10000000) 

# Paths
input_csv_path = "balanced_bio.csv"
output_csv_path = "balanced_formatted.csv"

# Reading and writing
with open(input_csv_path, mode='r', encoding='utf-8-sig') as csvfile:
    csvreader = csv.reader(csvfile)
    header = next(csvreader)

    with open(output_csv_path, mode='w', newline='', encoding='utf-8') as outcsv:
        csvwriter = csv.writer(outcsv)
        csvwriter.writerow(["Sentence #", "Word", "POS", "Tag"])

        sentence_id = 1

        for row in csvreader:
            words = row[0].split()
            labels = row[1].split()

            for word, label in zip(words, labels):
                # csvwriter.writerow([f"{sentence_id}", word, "NONE", label])
                csvwriter.writerow([f"Sentence: {sentence_id}", word, "NONE", label])
                # Check for a delimiter in the word to increment sentence number
                if "." in word:
                    sentence_id += 1
