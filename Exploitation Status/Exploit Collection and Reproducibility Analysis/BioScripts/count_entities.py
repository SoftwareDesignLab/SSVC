import pandas as pd

def count_b_and_o_labels(csv_file):
    # Read the CSV file into a DataFrame
    df = pd.read_csv(csv_file)

    # Drop rows with NaN label values
    df = df.dropna(subset=['label'])

    # Extract the labels from the "label" column
    labels = df['label']

    # Initialize dictionaries to store label counts
    b_label_counts = {}
    o_label_count = 0

    # Initialize total count for 'B' labels
    total_b_labels = 0

    # Iterate through each label
    for label in labels:
        for string in label.split():
            # Check if the label is 'O'
            if string == 'O':
                o_label_count += 1
            # Check if the label starts with 'B-'
            elif string.startswith('B-'):
                # Increment the total count for 'B' labels
                total_b_labels += 1

                # Extract the label type without the prefix 'B-'
                label_type = string[2:]

                # Increment the counter for the specific label type
                if label_type in b_label_counts:
                    b_label_counts[label_type] += 1
                else:
                    b_label_counts[label_type] = 1

    return b_label_counts, o_label_count, total_b_labels

# Example usage:
csv_file_path = 'balanced_bio.csv'
b_labels, o_labels, total_b_labels = count_b_and_o_labels(csv_file_path)

for label_type, count in b_labels.items():
    print(f"{label_type}: {count}")
print("Total B Labels: ", total_b_labels)

print("\nO Labels: ", o_labels)
